# HTTP Methods

Understanding HTTP methods: GET, POST, PUT, PATCH, DELETE - when to use each and RESTful conventions.

---

## Core Concept

**HTTP methods** (also called HTTP verbs) indicate the action you want to perform on a resource.

**Five Main Methods:**

1. **GET** - Retrieve data
2. **POST** - Create resource
3. **PUT** - Update/replace resource
4. **PATCH** - Partial update
5. **DELETE** - Delete resource

---

## GET

### Purpose

**GET** retrieves data from the server. It should **not** modify data.

**Characteristics:**

- ✅ **Safe** - Doesn't modify server state
- ✅ **Idempotent** - Same request = same result
- ✅ **Cacheable** - Responses can be cached
- ❌ **No body** - Should not send request body

---

### When to Use GET

✅ **Use GET for:**

- Fetching user data
- Getting list of items
- Searching/filtering
- Any read-only operation

❌ **Don't use GET for:**

- Creating resources
- Updating data
- Deleting data
- Any operation that modifies state

---

### GET Examples

```javascript
// Get all users
fetch("/api/users").then((res) => res.json());

// Get specific user
fetch("/api/users/123").then((res) => res.json());

// Search users
fetch("/api/users?name=John&age=30").then((res) => res.json());
```

**RESTful Convention:**

```
GET /api/users          → Get all users
GET /api/users/123      → Get user with ID 123
GET /api/users/123/posts → Get posts by user 123
```

---

## POST

### Purpose

**POST** creates a new resource on the server.

**Characteristics:**

- ❌ **Not safe** - Modifies server state
- ❌ **Not idempotent** - Same request = different result (creates new resource)
- ❌ **Not cacheable** - Responses shouldn't be cached
- ✅ **Has body** - Sends data in request body

---

### When to Use POST

✅ **Use POST for:**

- Creating new resources
- Submitting forms
- File uploads
- Any operation that creates something

❌ **Don't use POST for:**

- Retrieving data (use GET)
- Updating existing resources (use PUT/PATCH)
- Deleting resources (use DELETE)

---

### POST Examples

```javascript
// Create new user
fetch("/api/users", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    name: "John",
    email: "john@example.com",
  }),
});

// Submit form
fetch("/api/login", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    email: "user@example.com",
    password: "password123",
  }),
});
```

**RESTful Convention:**

```
POST /api/users          → Create new user
POST /api/users/123/posts → Create post for user 123
```

---

## PUT

### Purpose

**PUT** updates or replaces an entire resource.

**Characteristics:**

- ❌ **Not safe** - Modifies server state
- ✅ **Idempotent** - Same request = same result
- ❌ **Not cacheable** - Responses shouldn't be cached
- ✅ **Has body** - Sends complete resource data

---

### When to Use PUT

✅ **Use PUT for:**

- Replacing entire resource
- Updates where you send complete resource
- Idempotent updates

❌ **Don't use PUT for:**

- Partial updates (use PATCH)
- Creating resources (use POST)

---

### PUT Examples

```javascript
// Update entire user
fetch("/api/users/123", {
  method: "PUT",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    id: 123,
    name: "John Updated",
    email: "john.updated@example.com",
    age: 31,
  }),
});
```

**RESTful Convention:**

```
PUT /api/users/123 → Replace user 123 with new data
```

**Important:** PUT replaces the entire resource. Missing fields may be set to null/default.

---

## PATCH

### Purpose

**PATCH** performs a partial update on a resource.

**Characteristics:**

- ❌ **Not safe** - Modifies server state
- ❌ **Not idempotent** - May have different results
- ❌ **Not cacheable** - Responses shouldn't be cached
- ✅ **Has body** - Sends only fields to update

---

### When to Use PATCH

✅ **Use PATCH for:**

- Partial updates (update only some fields)
- When you don't want to send entire resource
- More efficient than PUT

❌ **Don't use PATCH for:**

- Replacing entire resource (use PUT)
- Creating resources (use POST)

---

### PATCH Examples

```javascript
// Update only user's email
fetch("/api/users/123", {
  method: "PATCH",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    email: "newemail@example.com",
  }),
});

// Update multiple fields
fetch("/api/users/123", {
  method: "PATCH",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    name: "John Updated",
    age: 31,
  }),
});
```

**RESTful Convention:**

```
PATCH /api/users/123 → Update only specified fields of user 123
```

---

## DELETE

### Purpose

**DELETE** removes a resource from the server.

**Characteristics:**

- ❌ **Not safe** - Modifies server state
- ✅ **Idempotent** - Same request = same result (resource deleted)
- ❌ **Not cacheable** - Responses shouldn't be cached
- ❌ **No body** - Usually no request body

---

### When to Use DELETE

✅ **Use DELETE for:**

- Deleting resources
- Removing data

❌ **Don't use DELETE for:**

- Retrieving data (use GET)
- Creating resources (use POST)
- Updating resources (use PUT/PATCH)

---

### DELETE Examples

```javascript
// Delete user
fetch("/api/users/123", {
  method: "DELETE",
});

// Delete with confirmation
fetch("/api/users/123", {
  method: "DELETE",
  headers: { Authorization: "Bearer token123" },
});
```

**RESTful Convention:**

```
DELETE /api/users/123 → Delete user 123
```

---

## Comparison Table

| Method     | Purpose  | Idempotent | Safe   | Body   | Use Case                |
| ---------- | -------- | ---------- | ------ | ------ | ----------------------- |
| **GET**    | Retrieve | ✅ Yes     | ✅ Yes | ❌ No  | Fetch data              |
| **POST**   | Create   | ❌ No      | ❌ No  | ✅ Yes | Create resource         |
| **PUT**    | Replace  | ✅ Yes     | ❌ No  | ✅ Yes | Replace entire resource |
| **PATCH**  | Update   | ❌ No      | ❌ No  | ✅ Yes | Partial update          |
| **DELETE** | Delete   | ✅ Yes     | ❌ No  | ❌ No  | Delete resource         |

---

## Idempotency

### What is Idempotency?

**Idempotent** means making the same request multiple times has the same effect as making it once.

**Idempotent Methods:**

- ✅ **GET** - Same request = same response
- ✅ **PUT** - Same request = same result (resource replaced)
- ✅ **DELETE** - Same request = same result (resource deleted)

**Non-Idempotent Methods:**

- ❌ **POST** - Same request = new resource each time
- ❌ **PATCH** - May have different results

**Why it matters:**

- Safe to retry idempotent requests
- Important for error handling and retries

---

## Safety

### What is Safety?

**Safe** methods don't modify server state.

**Safe Methods:**

- ✅ **GET** - Only retrieves data

**Unsafe Methods:**

- ❌ **POST, PUT, PATCH, DELETE** - All modify server state

**Why it matters:**

- Browsers can safely prefetch safe requests
- Safe methods can be cached

---

## RESTful Conventions

### Resource-Based URLs

```
GET    /api/users          → Get all users
GET    /api/users/123      → Get user 123
POST   /api/users          → Create new user
PUT    /api/users/123      → Replace user 123
PATCH  /api/users/123      → Update user 123
DELETE /api/users/123      → Delete user 123
```

### Nested Resources

```
GET    /api/users/123/posts        → Get posts by user 123
POST   /api/users/123/posts        → Create post for user 123
GET    /api/users/123/posts/456    → Get post 456 by user 123
DELETE /api/users/123/posts/456    → Delete post 456
```

---

## Common Mistakes

### Mistake 1: Using GET for Updates

```javascript
// ❌ Wrong - GET shouldn't modify data
fetch("/api/users/123?action=delete");

// ✅ Correct - Use DELETE
fetch("/api/users/123", { method: "DELETE" });
```

### Mistake 2: Using POST for Everything

```javascript
// ❌ Wrong - POST for update
fetch("/api/users/123", {
  method: "POST",
  body: JSON.stringify({ name: "Updated" }),
});

// ✅ Correct - Use PATCH for partial update
fetch("/api/users/123", {
  method: "PATCH",
  body: JSON.stringify({ name: "Updated" }),
});
```

### Mistake 3: Using PUT for Partial Updates

```javascript
// ❌ Wrong - PUT replaces entire resource
fetch("/api/users/123", {
  method: "PUT",
  body: JSON.stringify({ email: "new@example.com" }), // Missing fields!
});

// ✅ Correct - Use PATCH for partial update
fetch("/api/users/123", {
  method: "PATCH",
  body: JSON.stringify({ email: "new@example.com" }),
});
```

---

## Common Questions

### Q: What's the difference between PUT and PATCH?

**A:**

- **PUT** - Replaces entire resource (must send all fields)
- **PATCH** - Updates only specified fields (partial update)

### Q: Can I send a body with GET?

**A:** Technically yes, but it's not recommended. GET should be used for retrieving data, and query parameters are preferred.

### Q: Is POST idempotent?

**A:** No. POST creates new resources, so the same request creates different resources each time.

### Q: What if an API doesn't support PATCH?

**A:** Use PUT, but you may need to send the entire resource. Some APIs use POST for updates (not RESTful, but common).

---

## Related Topics

- [HTTP Status Codes](./03.%20HTTP%20Status%20Codes.md) - Response codes for each method
- [REST API Principles](./06.%20REST%20API%20Principles.md) - RESTful design
- [Error Handling](./07.%20Error%20Handling.md) - Handling errors for each method
- [HTTP Headers](./04.%20HTTP%20Headers.md) - Headers for each method
- [Form Submissions](../../19.%20Browser%20Internals/4.%20Form%20Submissions.md) - HTML forms only support GET/POST

---

## Summary

**HTTP Methods:**

- **GET** - Retrieve data (safe, idempotent)
- **POST** - Create resource (not safe, not idempotent)
- **PUT** - Replace resource (idempotent)
- **PATCH** - Partial update (not idempotent)
- **DELETE** - Delete resource (idempotent)

**Key Rules:**

- Use correct method for the operation
- GET should never modify data
- PUT replaces, PATCH updates partially
- Follow RESTful conventions
