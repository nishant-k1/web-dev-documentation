# HTTP Request Response Structure

Understanding the structure of HTTP requests and responses.

---

## Core Concept

Every HTTP request and response follows a specific structure with three main parts:

1. **Start line** (request line or status line)
2. **Headers**
3. **Body** (optional)

---

## HTTP Request Structure

### Request Components

```
[Request Line]
[Headers]
[Blank Line]
[Body] (optional)
```

---

### Request Line

**Format:**

```
[Method] [Request-URI] [HTTP-Version]
```

**Example:**

```
GET /api/users HTTP/1.1
POST /api/users HTTP/1.1
DELETE /api/users/123 HTTP/1.1
```

**Components:**

- **Method** - HTTP method (GET, POST, PUT, etc.)
- **Request-URI** - Path and query string
- **HTTP-Version** - HTTP/1.1, HTTP/2, etc.

---

### Complete Request Example

```
POST /api/users HTTP/1.1
Host: api.example.com
Content-Type: application/json
Authorization: Bearer token123
Content-Length: 45

{
  "name": "John",
  "email": "john@example.com"
}
```

**Breakdown:**

1. **Request Line:** `POST /api/users HTTP/1.1`
2. **Headers:** `Host`, `Content-Type`, `Authorization`, `Content-Length`
3. **Blank Line:** Separates headers from body
4. **Body:** JSON data

---

## HTTP Response Structure

### Response Components

```
[Status Line]
[Headers]
[Blank Line]
[Body] (optional)
```

---

### Status Line

**Format:**

```
[HTTP-Version] [Status-Code] [Status-Message]
```

**Example:**

```
HTTP/1.1 200 OK
HTTP/1.1 201 Created
HTTP/1.1 404 Not Found
HTTP/1.1 500 Internal Server Error
```

**Components:**

- **HTTP-Version** - HTTP/1.1, HTTP/2, etc.
- **Status-Code** - 200, 404, 500, etc.
- **Status-Message** - OK, Not Found, etc.

---

### Complete Response Example

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 45
Cache-Control: public, max-age=3600
ETag: "abc123"

{
  "id": 1,
  "name": "John",
  "email": "john@example.com"
}
```

**Breakdown:**

1. **Status Line:** `HTTP/1.1 200 OK`
2. **Headers:** `Content-Type`, `Content-Length`, `Cache-Control`, `ETag`
3. **Blank Line:** Separates headers from body
4. **Body:** JSON data

---

## Request Structure Details

### Method

**HTTP Methods:**

- GET, POST, PUT, PATCH, DELETE
- OPTIONS, HEAD, TRACE, CONNECT

**Example:**

```
GET /api/users
POST /api/users
PUT /api/users/123
```

---

### Request URI

**Components:**

- **Path** - `/api/users`
- **Query String** - `?page=1&limit=10`
- **Fragment** - `#section` (not sent to server)

**Examples:**

```
/api/users
/api/users/123
/api/users?page=1&limit=10
/api/search?q=javascript&type=article
```

---

### Headers Section

**Format:**

```
Header-Name: header-value
```

**Multiple headers:**

```
Content-Type: application/json
Authorization: Bearer token123
Accept: application/json
User-Agent: MyApp/1.0
```

**Important:** Each header on its own line.

---

### Body Section

**When present:**

- POST, PUT, PATCH requests
- Contains data being sent

**Format:** Depends on Content-Type header

**JSON Example:**

```
{
  "name": "John",
  "email": "john@example.com"
}
```

**Form Data Example:**

```
name=John&email=john@example.com
```

---

## Response Structure Details

### Status Code

**3-digit number indicating result:**

- 2xx - Success
- 3xx - Redirect
- 4xx - Client Error
- 5xx - Server Error

**Example:**

```
200 OK
201 Created
404 Not Found
500 Internal Server Error
```

---

### Headers Section

**Common response headers:**

```
Content-Type: application/json
Content-Length: 1024
Cache-Control: public, max-age=3600
Set-Cookie: sessionId=abc123
Location: /api/users/123
```

---

### Body Section

**Contains response data:**

- JSON for APIs
- HTML for web pages
- Binary data for files

**Example:**

```json
{
  "id": 1,
  "name": "John",
  "email": "john@example.com"
}
```

---

## Visual Structure

### Request Structure

```
┌─────────────────────────────────────┐
│ Request Line                        │
│ POST /api/users HTTP/1.1           │
├─────────────────────────────────────┤
│ Headers                             │
│ Host: api.example.com               │
│ Content-Type: application/json      │
│ Authorization: Bearer token         │
├─────────────────────────────────────┤
│ [Blank Line]                        │
├─────────────────────────────────────┤
│ Body                                │
│ { "name": "John" }                 │
└─────────────────────────────────────┘
```

### Response Structure

```
┌─────────────────────────────────────┐
│ Status Line                         │
│ HTTP/1.1 200 OK                    │
├─────────────────────────────────────┤
│ Headers                             │
│ Content-Type: application/json      │
│ Content-Length: 45                  │
├─────────────────────────────────────┤
│ [Blank Line]                        │
├─────────────────────────────────────┤
│ Body                                │
│ { "id": 1, "name": "John" }        │
└─────────────────────────────────────┘
```

---

## Real-World Examples

### Example 1: GET Request

**Request:**

```
GET /api/users/123 HTTP/1.1
Host: api.example.com
Accept: application/json
Authorization: Bearer token123
```

**Response:**

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 45

{
  "id": 123,
  "name": "John",
  "email": "john@example.com"
}
```

---

### Example 2: POST Request

**Request:**

```
POST /api/users HTTP/1.1
Host: api.example.com
Content-Type: application/json
Authorization: Bearer token123
Content-Length: 45

{
  "name": "Jane",
  "email": "jane@example.com"
}
```

**Response:**

```
HTTP/1.1 201 Created
Content-Type: application/json
Location: /api/users/124
Content-Length: 50

{
  "id": 124,
  "name": "Jane",
  "email": "jane@example.com"
}
```

---

### Example 3: DELETE Request

**Request:**

```
DELETE /api/users/123 HTTP/1.1
Host: api.example.com
Authorization: Bearer token123
```

**Response:**

```
HTTP/1.1 204 No Content
Content-Length: 0
```

---

## HTTP/2 Differences

### HTTP/1.1 (Text-based)

```
POST /api/users HTTP/1.1
Host: api.example.com
Content-Type: application/json

{ "name": "John" }
```

### HTTP/2 (Binary)

- Same logical structure
- Binary encoding (more efficient)
- Headers compressed
- Multiple requests over single connection

**Note:** Structure is the same, just encoded differently.

---

## Common Questions

### Q: What's the blank line for?

**A:** Separates headers from body. Required when body is present.

### Q: Can I have multiple request lines?

**A:** No. Only one request line per request.

### Q: What if there's no body?

**A:** Just omit the body section. Blank line not needed if no body.

### Q: What's the difference between request URI and URL?

**A:**

- **URI** - `/api/users?page=1` (path + query)
- **URL** - `https://api.example.com/api/users?page=1` (full address)

Request line uses URI (without protocol/domain).

---

## Related Topics

- [HTTP Protocol Basics](./01.%20HTTP%20Protocol%20Basics.md) - HTTP overview
- [HTTP Methods](./02.%20HTTP%20Methods.md) - Request methods
- [HTTP Status Codes](./03.%20HTTP%20Status%20Codes.md) - Response status
- [HTTP Headers](./04.%20HTTP%20Headers.md) - Header details
- [Browser Request Lifecycle](../../19.%20Browser%20Internals/1.%20Browser%20Request%20Lifecycle.md) - How browsers structure requests

---

## Summary

**Request Structure:**

1. **Request Line** - Method, URI, HTTP version
2. **Headers** - Metadata
3. **Blank Line** - Separator
4. **Body** - Data (optional)

**Response Structure:**

1. **Status Line** - HTTP version, status code, message
2. **Headers** - Metadata
3. **Blank Line** - Separator
4. **Body** - Data (optional)

**Key Points:**

- Blank line separates headers from body
- Body is optional (GET, DELETE often have no body)
- Headers are key-value pairs
- Structure is consistent across HTTP versions
