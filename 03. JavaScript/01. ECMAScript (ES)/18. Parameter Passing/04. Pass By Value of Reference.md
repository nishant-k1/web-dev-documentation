# Pass By Value of Reference (Technical Implementation)

JavaScript technically passes **a copy of the reference** (pass by value of reference), not true pass by reference. This subtle distinction is important to understand.

---

## The Technical Truth

While we say JavaScript passes objects "by reference," it's more accurate to say:

> **JavaScript passes a copy of the reference by value**

This means:

- The **reference itself** is copied (not the object)
- The parameter gets its own copy of the reference
- Both references point to the same object
- Reassigning the parameter doesn't affect the original variable

---

## True Pass By Reference vs JavaScript

### True Pass By Reference (C++)

In languages with true pass by reference:

```cpp
void modify(int& x) {  // & means reference
  x = 100;  // Directly modifies the original variable
}

int num = 10;
modify(num);
// num is now 100 (original variable changed)
```

**Key difference:** The parameter is an **alias** for the original variable.

### JavaScript's Behavior

```javascript
function modify(obj) {
  obj = { value: 100 }; // Only affects local parameter
}

let myObj = { value: 10 };
modify(myObj);
// myObj is still { value: 10 } (original unchanged)
```

**Why?** `obj` is a **copy of the reference**, not an alias for `myObj`.

---

## Memory Model Explained

### Step 1: Original Variable

```javascript
let myObj = { a: 10 };
```

```
Memory:
myObj (variable) → [ref1] → { a: 10 } (object in heap)
```

### Step 2: Passing to Function

```javascript
function modify(obj) {
  // obj receives a COPY of ref1
}
modify(myObj);
```

```
Memory:
myObj (variable) → [ref1] ─┐
                           ├─→ { a: 10 } (same object)
obj (parameter)  → [ref1] ─┘  (copy of reference)
```

### Step 3: Modifying Object Properties

```javascript
function modify(obj) {
  obj.a = 42; // Modifies the shared object
}
```

```
Memory:
myObj (variable) → [ref1] ─┐
                           ├─→ { a: 42 } (modified object)
obj (parameter)  → [ref1] ─┘  (both point to same object)
```

### Step 4: Reassigning Parameter

```javascript
function modify(obj) {
  obj = { a: 100 }; // Creates new object, new reference
}
```

```
Memory:
myObj (variable) → [ref1] → { a: 10 } (original, unchanged)
obj (parameter)  → [ref2] → { a: 100 } (new object, new reference)
```

---

## Why This Matters

Understanding "pass by value of reference" explains:

1. **Why property modifications work** - Both references point to same object
2. **Why reassignment doesn't work** - Only the local reference copy changes
3. **Why it's called "pass by reference"** - Conceptually, you're passing a reference
4. **The technical accuracy** - The reference itself is copied

---

## Visual Analogy

Think of it like this:

- **True pass by reference**: Two names for the same person

  - Change one name, the other reflects it
  - They're the same entity

- **JavaScript's behavior**: Two people pointing at the same house
  - Both can modify the house (shared object)
  - But if one person points at a different house (reassignment), the other still points at the original

---

## Code Examples

### Example 1: Property Modification Works

```javascript
function modifyProperty(obj) {
  obj.value = 100; // Both references point to same object
}

let myObj = { value: 10 };
modifyProperty(myObj);
console.log(myObj.value); // 100 (modified)
```

**Why it works:** Both `myObj` and `obj` hold references to the same object.

### Example 2: Reassignment Doesn't Work

```javascript
function reassign(obj) {
  obj = { value: 100 }; // Only obj's reference changes
}

let myObj = { value: 10 };
reassign(myObj);
console.log(myObj.value); // 10 (unchanged)
```

**Why it doesn't work:** `obj` gets a new reference, but `myObj` keeps its original reference.

### Example 3: Both References Independent

```javascript
function test(obj) {
  console.log(obj === myObj); // true (point to same object)
  obj = { new: true }; // obj gets new reference
  console.log(obj === myObj); // false (now different)
}

let myObj = { original: true };
test(myObj);
console.log(myObj); // { original: true } (unchanged)
```

---

## Comparison with Other Languages

| Language           | Object Passing    | Can Reassign Parameter?         |
| ------------------ | ----------------- | ------------------------------- |
| JavaScript         | Copy of reference | ❌ No (doesn't affect original) |
| C++ (by reference) | True reference    | ✅ Yes (affects original)       |
| Java               | Copy of reference | ❌ No (same as JavaScript)      |
| Python             | Copy of reference | ❌ No (same as JavaScript)      |

---

## Practical Implications

### ✅ What Works (Property Modification)

```javascript
// Modifying properties - works
function updateUser(user) {
  user.name = "Updated";
  user.age = 30;
}

let person = { name: "Original", age: 25 };
updateUser(person);
console.log(person); // { name: "Updated", age: 30 }
```

### ❌ What Doesn't Work (Reassignment)

```javascript
// Reassigning parameter - doesn't work
function replaceUser(user) {
  user = { name: "New", age: 0 };
}

let person = { name: "Original", age: 25 };
replaceUser(person);
console.log(person); // { name: "Original", age: 25 }
```

### ✅ Workaround: Return New Object

```javascript
// Return new object instead
function createUpdatedUser(user) {
  return { ...user, name: "Updated", age: 30 };
}

let person = { name: "Original", age: 25 };
person = createUpdatedUser(person); // Reassign original variable
console.log(person); // { name: "Updated", age: 30 }
```

---

## Interview Questions

### Q: Why doesn't this work?

```javascript
function swap(a, b) {
  let temp = a;
  a = b;
  b = temp;
}

let x = 10;
let y = 20;
swap(x, y);
console.log(x, y); // 10, 20 (not swapped!)
```

**Answer:** Primitives are passed by value, so `a` and `b` are copies. Reassigning them doesn't affect `x` and `y`.

### Q: Why does this work?

```javascript
function swapProperties(obj) {
  let temp = obj.a;
  obj.a = obj.b;
  obj.b = temp;
}

let myObj = { a: 10, b: 20 };
swapProperties(myObj);
console.log(myObj); // { a: 20, b: 10 } (swapped!)
```

**Answer:** Objects are passed by reference (copy of reference). Modifying properties affects the shared object.

---

## Summary

- **Primitives**: Passed by value (copy of value)
- **Objects**: Passed by value of reference (copy of reference)
- **Property modifications**: Work (shared object)
- **Parameter reassignment**: Doesn't affect original (independent references)

---

## Related Topics

- [2. Pass By Value.md](./2.%20Pass%20By%20Value.md) - Primitive passing
- [3. Pass By Reference.md](./3.%20Pass%20By%20Reference.md) - Object passing
- [14. Copying](../13.%20Copying/) - How to create copies
- [13. Comparing](../12.%20Comparing/) - How references are compared
