# FP Core Principles: Higher-Order Functions and Callbacks

---

## Higher-Order Functions (HOFs)

A **Higher-Order Function (HOF)** is a function that:

- Takes one or more functions as arguments (callbacks), **OR**
- Returns a new function (often newly created or a modified version of an input function), **OR**
- Both of the above

### Key Points

- The callback function does not need to be executed inside the HOF. Simply receiving a function as an argument qualifies it as a HOF.
- Even if a function does not take a function as an argument but returns another function, it is still considered a HOF.
- If a function receives a callback and returns a modified version of that callback (e.g., by wrapping or enhancing it), it is also a HOF.

---

## HOF Examples

### Example 1: HOF That Returns a Function

```javascript
// HOF that returns a function
const hof = () => () => 5;
hof()(); // returns 5
```

### Example 2: HOF That Takes a Function

```javascript
// HOF that takes a function as argument
const hof = (fn) => fn(5);
hof(function callback(x) {
  return x;
}); // returns 5
```

### Example 3: HOF That Does Both

```javascript
function createMultiplier(multiplier) {
  return function (number) {
    return number * multiplier;
  };
}

const double = createMultiplier(2); // Returns a function
double(5); // 10
```

---

## Callback Functions

A **callback function** is a function that:

- Is passed as an argument to another function
- Is meant to be invoked by the function it's passed into (either immediately or eventually)

### Key Points

- A function is considered a callback only when the receiving function (the HOF) is expected to call itâ€”either immediately or eventually.
- If the passed function doesn't get invoked inside the body of the HOF, then it would not be called a callback function. It's simply a function being passed and returnedâ€”but not being used as a callback.

---

## HOF vs Callback: The Relationship

### Higher-Order Functions

A higher-order function is a function that can take one or more functions as arguments or can return a function as its result (or both). In other words, it treats functions as first-class citizens.

```JavaScript
function higherOrderFunction(callback) {
  console.log("This is the higher-order function");
  callback(); // This is where the callback function is called
}

function callbackFunction() {
  console.log("This is the callback function");
}

higherOrderFunction(callbackFunction);
```

### Callback Functions

A callback function is a function that is passed as an argument to another function and is executed inside the body of that another function.

```JavaScript
function doSomethingAsync(callback) {
  setTimeout(function() {
    console.log("Async operation done");
    callback(); // Callback is invoked here
  }, 2000);
}

function onComplete() {
  console.log("Callback called");
}

doSomethingAsync(onComplete);
```

**Relationship:** HOFs receive callbacks. Callbacks are passed to HOFs.

---

## Common HOFs in JavaScript

### Array Methods

All of these are HOFs because they take functions as arguments:

```js
[1, 2, 3].map((x) => x * 2); // HOF: takes function as argument
[1, 2, 3].filter((x) => x > 1); // HOF: takes function as argument
[1, 2, 3].reduce((acc, x) => acc + x, 0); // HOF: takes function as argument
[1, 2, 3].forEach((x) => console.log(x)); // HOF: takes function as argument
[1, 2, 3].some((x) => x > 2); // HOF: takes function as argument
[1, 2, 3].every((x) => x > 0); // HOF: takes function as argument
```

### Function Utilities

```js
// setTimeout, setInterval are HOFs
setTimeout(() => console.log("Hi"), 1000);

// Event listeners
button.addEventListener("click", handler); // handler is callback

// Promise methods
promise.then((data) => console.log(data)); // then is HOF, function is callback
```

---

## Real-World Examples

### Example 1: Custom HOF for Retry Logic

```js
function retry(fn, maxAttempts = 3) {
  return async function (...args) {
    for (let i = 0; i < maxAttempts; i++) {
      try {
        return await fn(...args);
      } catch (error) {
        if (i === maxAttempts - 1) throw error;
        await new Promise((resolve) => setTimeout(resolve, 1000));
      }
    }
  };
}

const fetchWithRetry = retry(fetch);
```

### Example 2: HOF for Logging

```js
function withLogging(fn) {
  return function (...args) {
    console.log(`Calling ${fn.name} with`, args);
    const result = fn(...args);
    console.log(`${fn.name} returned`, result);
    return result;
  };
}

const add = (a, b) => a + b;
const loggedAdd = withLogging(add);
loggedAdd(2, 3); // Logs the call and result
```

### Example 3: HOF for Timing

```js
function measureTime(fn) {
  return function (...args) {
    const start = performance.now();
    const result = fn(...args);
    const end = performance.now();
    console.log(`${fn.name} took ${end - start}ms`);
    return result;
  };
}

const slowFunction = (n) => {
  // Some computation
  return n * 2;
};

const timedSlowFunction = measureTime(slowFunction);
timedSlowFunction(5);
```

---

## Benefits of HOFs

1. **Abstraction** - Hide implementation details
2. **Reusability** - Write generic functions that work with different behaviors
3. **Composability** - Build complex operations from simple functions
4. **Flexibility** - Change behavior by passing different functions

---

## Interview Points

- HOFs take functions as arguments or return functions
- Callbacks are functions passed to HOFs to be executed
- JavaScript's array methods (`map`, `filter`, `reduce`) are all HOFs
- HOFs enable function composition and higher-level abstractions
- First-class functions make HOFs possible
- HOFs abstract common patterns and make code more reusable

---

> ðŸ“– **Related Topics:**
>
> - [03. First-Class Functions.md](./03.%20First-Class%20Functions.md) - Foundation for HOFs
> - [09. Map, Filter, and Reduce.md](./09.%20Map,%20Filter,%20and%20Reduce.md) - Common HOFs in practice
> - [10. Function Composition.md](./10.%20Function%20Composition.md) - Combining functions

