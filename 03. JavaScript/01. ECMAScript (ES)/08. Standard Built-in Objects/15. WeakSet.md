# ‚úÖ Must-Know `WeakSet` Object

`WeakSet` is a collection of **weakly held objects**. Objects can be garbage collected even if they're in the WeakSet.

---

## Key Characteristics

- ‚úÖ **Only objects** as values (no primitives)
- ‚úÖ **Weak references** - doesn't prevent GC
- ‚ùå **Not iterable** - no `forEach`, `for...of`, `keys()`, `values()`, `entries()`
- ‚ùå **No size property** - cannot get count
- ‚úÖ **Automatic cleanup** - entries removed when objects are GC'd

---

## Creating WeakSet

```js
// Empty WeakSet
const weakSet = new WeakSet();

// From array of objects
const obj1 = { id: 1 };
const obj2 = { id: 2 };
const weakSet = new WeakSet([obj1, obj2]);

// Cannot use primitives
const weakSet = new WeakSet([1, 2, 3]); // TypeError
```

---

## WeakSet Methods

| Method                | Description             | Returns   |
| --------------------- | ----------------------- | --------- |
| `weakSet.add(obj)`    | Adds object to set      | `WeakSet` |
| `weakSet.has(obj)`    | Checks if object exists | `boolean` |
| `weakSet.delete(obj)` | Removes object from set | `boolean` |

**Note:** No `clear()` or `size` property!

---

## Common Use Cases

### 1. Tracking Objects Without Preventing GC

```js
const trackedObjects = new WeakSet();

function track(obj) {
  trackedObjects.add(obj);
}

function isTracked(obj) {
  return trackedObjects.has(obj);
}

// When obj is GC'd, it's automatically removed from WeakSet
```

### 2. Preventing Circular References

```js
const seen = new WeakSet();

function deepClone(obj) {
  if (seen.has(obj)) {
    throw new Error("Circular reference detected");
  }
  seen.add(obj);
  // ... cloning logic
}
```

### 3. Marking Objects

```js
const processed = new WeakSet();

function processUser(user) {
  if (processed.has(user)) {
    return; // Already processed
  }
  processed.add(user);
  // Process user
}
```

---

## WeakSet vs Set

| Feature      | WeakSet                       | Set                |
| ------------ | ----------------------------- | ------------------ |
| **Values**   | Objects only                  | Any type           |
| **Iterable** | ‚ùå No                         | ‚úÖ Yes             |
| **Size**     | ‚ùå No                         | ‚úÖ Yes             |
| **GC**       | ‚úÖ Weak (auto cleanup)        | ‚ùå Strong          |
| **Use Case** | Tracking without memory leaks | Unique collections |

---

## Important Notes

### ‚ö†Ô∏è Only Objects

```js
const weakSet = new WeakSet();
weakSet.add(1); // TypeError: Invalid value used in weak set
weakSet.add("string"); // TypeError
weakSet.add({}); // ‚úÖ OK
```

### ‚ö†Ô∏è Cannot Iterate

```js
const weakSet = new WeakSet([obj1, obj2]);

// These don't exist:
weakSet.forEach(); // TypeError
for (const obj of weakSet) {
} // TypeError
weakSet.keys(); // TypeError
weakSet.size; // undefined
```

### ‚úÖ Automatic Cleanup

```js
let obj = { data: "test" };
const weakSet = new WeakSet([obj]);

weakSet.has(obj); // true

// Clear strong reference
obj = null;

// Eventually, obj is GC'd and removed from WeakSet automatically
// (Can't verify this directly, but it happens)
```

---

## Interview Common Questions

### Q: What is WeakSet?

A collection of weakly referenced objects. Objects can be garbage collected even if they're in the WeakSet, preventing memory leaks.

### Q: Why use WeakSet over Set?

When you want to track objects without preventing their garbage collection. Useful for preventing memory leaks when tracking temporary objects.

### Q: Can WeakSet have primitives?

No, only objects. Attempting to add primitives throws TypeError.

### Q: Can you iterate over WeakSet?

No. WeakSet is not iterable - no `forEach`, `for...of`, `keys()`, `values()`, or `entries()` methods.

---

üìñ **See Also:**

- [03. Special Types (Map, Set, WeakMap, WeakSet)](<../../04.%20Data%20Types/03.%20Special%20Types%20(Map,%20Set,%20WeakMap,%20WeakSet).md>) for comprehensive WeakSet documentation
- [15. Set.md](./15.%20Set.md) for Set
