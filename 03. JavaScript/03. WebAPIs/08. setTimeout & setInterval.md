# âœ… Must-Know `setTimeout` & `setInterval` â­â­â­â­â­

`setTimeout` and `setInterval` are timer functions provided by the browser's Web APIs. **Most frequently asked in JavaScript interviews!**

---

## setTimeout

Executes a function **once** after a specified delay.

### Syntax

```js
const timeoutId = setTimeout(callback, delay, ...args);
```

**Parameters:**

- `callback`: Function to execute
- `delay`: Delay in milliseconds (default: 0)
- `...args`: Optional arguments to pass to callback

**Returns:** Timeout ID (number) used to cancel the timeout

### Basic Usage

```js
setTimeout(() => {
  console.log("Hello after 1 second");
}, 1000);

// With arguments
setTimeout(
  (name, age) => {
    console.log(`Hello, ${name}, age ${age}`);
  },
  1000,
  "John",
  30
);
```

### clearTimeout

Cancels a timeout before it executes.

```js
const timeoutId = setTimeout(() => {
  console.log("This won't run");
}, 1000);

clearTimeout(timeoutId); // Cancelled!
```

---

## setInterval

Executes a function **repeatedly** at specified intervals.

### Syntax

```js
const intervalId = setInterval(callback, delay, ...args);
```

**Parameters:** Same as `setTimeout`

**Returns:** Interval ID (number) used to cancel the interval

### Basic Usage

```js
setInterval(() => {
  console.log("Runs every second");
}, 1000);

// Countdown timer
let count = 5;
const intervalId = setInterval(() => {
  console.log(count);
  count--;
  if (count < 0) {
    clearInterval(intervalId); // Stop at 0
  }
}, 1000);
```

### clearInterval

Stops an interval from running.

```js
const intervalId = setInterval(() => {
  console.log("Tick");
}, 1000);

// Stop after 5 seconds
setTimeout(() => {
  clearInterval(intervalId);
  console.log("Stopped!");
}, 5000);
```

---

## Important Notes

### Minimum Delay

The actual delay may be longer than specified:

```js
setTimeout(() => console.log("Hello"), 0);
console.log("World");
// Output: World, Hello (even with 0ms delay)
```

**Why?** `setTimeout` callbacks are added to the **macrotask queue** and execute after the current call stack is empty.

### Delay Behavior

```js
// These execute in order (not immediately)
setTimeout(() => console.log("A"), 0);
setTimeout(() => console.log("B"), 0);
setTimeout(() => console.log("C"), 0);
console.log("D");
// Output: D, A, B, C
```

### This Binding

Be careful with `this` in callbacks:

```js
const obj = {
  name: "John",
  greet() {
    console.log(this.name);
  },
};

setTimeout(obj.greet, 1000); // undefined âŒ (loses this)
setTimeout(() => obj.greet(), 1000); // "John" âœ…
setTimeout(obj.greet.bind(obj), 1000); // "John" âœ…
```

---

## Common Patterns

### Debouncing

Limits function execution frequency.

```js
function debounce(func, delay) {
  let timeoutId;
  return function (...args) {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => func.apply(this, args), delay);
  };
}

// Usage
const debouncedSearch = debounce((query) => {
  console.log("Searching:", query);
}, 500);
```

### Throttling

Ensures function executes at most once per interval.

```js
function throttle(func, delay) {
  let lastCall = 0;
  return function (...args) {
    const now = Date.now();
    if (now - lastCall >= delay) {
      lastCall = now;
      func.apply(this, args);
    }
  };
}

// Usage
const throttledScroll = throttle(() => {
  console.log("Scrolled!");
}, 1000);
```

### Timeout Pattern

Execute function with timeout limit.

```js
function withTimeout(promise, timeoutMs) {
  return Promise.race([
    promise,
    new Promise((_, reject) =>
      setTimeout(() => reject(new Error("Timeout")), timeoutMs)
    ),
  ]);
}
```

---

## Common Use Cases

### 1. Delayed Execution

```js
// Show message after delay
setTimeout(() => {
  alert("Welcome!");
}, 2000);
```

### 2. Animation/Updates

```js
// Update UI periodically
setInterval(() => {
  updateClock();
}, 1000);
```

### 3. Polling

```js
// Check for updates every 5 seconds
const pollId = setInterval(async () => {
  const data = await fetch("/api/status");
  if (data.complete) {
    clearInterval(pollId);
  }
}, 5000);
```

---

## Interview Common Questions

### Q: What's the difference between setTimeout and setInterval?

**setTimeout:**

- Executes callback **once** after delay
- Returns timeout ID
- Use `clearTimeout()` to cancel

**setInterval:**

- Executes callback **repeatedly** at intervals
- Returns interval ID
- Use `clearInterval()` to stop

### Q: What's the minimum delay for setTimeout?

Technically 0ms, but callbacks execute **after** the current call stack is empty (minimum ~4ms in browsers). Even `setTimeout(fn, 0)` doesn't execute immediately.

### Q: How does setTimeout work with the event loop?

`setTimeout` callbacks are added to the **macrotask queue**. They execute after:

1. Current call stack is empty
2. All microtasks (Promises) are processed

```js
console.log("1");
setTimeout(() => console.log("2"), 0);
Promise.resolve().then(() => console.log("3"));
console.log("4");
// Output: 1, 4, 3, 2
```

### Q: How to implement debouncing?

```js
function debounce(func, delay) {
  let timeoutId;
  return function (...args) {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => func.apply(this, args), delay);
  };
}
```

### Q: How to implement throttling?

```js
function throttle(func, delay) {
  let lastCall = 0;
  return function (...args) {
    const now = Date.now();
    if (now - lastCall >= delay) {
      lastCall = now;
      func.apply(this, args);
    }
  };
}
```

---

## Common Mistakes

### âŒ Forgetting to Clear Intervals

```js
// Memory leak!
setInterval(() => {
  // Runs forever
}, 1000);
```

### âŒ Wrong This Binding

```js
const obj = {
  count: 0,
  increment() {
    this.count++;
  },
};

setInterval(obj.increment, 1000); // âŒ this is undefined
setInterval(() => obj.increment(), 1000); // âœ… Works
```

### âŒ Assuming Exact Timing

```js
// Don't rely on exact timing
setTimeout(() => {
  // May execute slightly later than 1000ms
}, 1000);
```

---

ðŸ“– **See Also:**

- [07. Event Loop.md](<../02.%20JavaScript%20Runtime%20Environment%20(JRE)/07.%20Event%20Loop.md>) for how timers work in the event loop
- [14. Async Operations.md](<../02.%20JavaScript%20Runtime%20Environment%20(JRE)/14.%20Async%20Operations.md>) for async patterns
